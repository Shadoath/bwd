<%= render :partial => 'restaurant_header', locals: {restaurant: @restaurant} %>
<div class="row">
  <% unless @menus.empty? %>
    <% @menus.each do |menu| %>
      <% if menu.name && !menu.name.empty? && !menu.name == "Default" %>
        <div class="small-12 columns">
          <h2><%= menu.name %> Menu </h2>
        </div>
      <% end %>
      <% unless menu.menu_groups.empty? %>
        <ul class="tabs" data-tabs id="menu-group-tabs-<%= menu.id %>">
          <% menu.menu_groups.each_with_index do |menu_group, index| %>
            <li class="tabs-title <%= index==0 ? 'is-active' : ''%>" ><a href="#menu_group-<%= menu_group.id %>"><%= menu_group.name %></a></li>
          <% end %>
        </ul>
        <div class="tabs-content" data-tabs-content="menu-group-tabs-<%= menu.id %>">
          <% menu.menu_groups.each_with_index do |menu_group, index| %>
            <div class="tabs-panel <%= index==0 ? 'is-active' : ''%>" id="menu_group-<%= menu_group.id %>">
              <div class="col s12 cards-container">
                <div class="row" style="display:flex;flex-wrap:wrap">
                  <% menu_group.items.sort_by{ |i| [i.reviews.present? ? -Review.ratings[i.reviews.first.rating] : 0, i.name]}.each do |item| %>
                    <div class="card col s12 m6 l4">
                      <div class="card-content">
                        <h3 class="card-title"><%= link_to item.name, restaurant_item_path(@restaurant, item) %></h3>
                        <div class="center card-image">
                          <%= link_to PhotoDecorator.decorate(item.photos).display, restaurant_item_path(@restaurant, item) %>
                        </div>
                        <% if current_user %>
                          <div id="rating-reviews-item-<%=item.id%>" class="review-rating-wrapper">
                            <% review = item.reviews.first %>
                            <% if review.present? %>
                              <%= render partial: "/modules/rating_reviews", locals: { rating: Review.ratings[review.rating], reviewable: item } %>
                            <% else %>
                              <%= render partial: "/modules/rating_reviews", locals: { rating: 0, reviewable: item } %>
                            <% end %>
                          </div>
                        <% end %>
                        <p class="black-text"><%= item.description %></p>
                        <% item.prices.each do |price_size| %>
                          <div class="right-align">
                            <span class="red-text"><%= price_to_s(price_size.value) %><%= "/#{price_size.size}" if price_size.size && !price_size.size.empty? %></span><br>
                          </div>
                        <% end %>
                      </div>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>
<% end %>
</div>
<hr>
<h5><%= link_to "Home", root_path, :class => "button tiny radius success" %></h5>

<!-- <div class="small-3 columns">
  <h5><%= link_to "Make Fav", new_review_path(@restaurant), :class => "button tiny radius success right" %></h5>
</div> -->
